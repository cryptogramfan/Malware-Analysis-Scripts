# graph_similar_strings.py
 A script that reads a list of strings and generates link charts that clusters similar strings together. Three string similarity metrics are supported:
 * [Jaccard distance](https://en.wikipedia.org/wiki/Jaccard_index)
 * [Hamming distance](https://en.wikipedia.org/wiki/Hamming_distance)
 * [Levenshtein distance](https://en.wikipedia.org/wiki/Levenshtein_distance)
 
 The script can be used as an exploratory data analysis technique for identifying phishing campaigns, for example by clustering similiar filenames and email subject lines. To use the script, supply a text file containing a list of strings. By default, the script outputs DOT files that can be exported as images using [Graphviz](https://www.graphviz.org/). If Graphviz is in your PATH the script can export to SVG (recommended) or PNG files for you. You can modify the thresholds that determine if two strings are similar enough to connect according to your needs.

 ## Installation
 First install Graphviz. On Windows you can download the installer [here](https://graphviz.gitlab.io/_pages/Download/Download_windows.html). On Linux you can install Graphviz by running:
 ``` 
 $ sudo apt install graphviz
 ```
 Afterwards, install the required Python libraries:
 ```
 $ pip install -r requirements.txt
 ```
 To view SVG files produced by the script you can use a viewer such as [Inkscape](https://inkscape.org/). Outputting to PNG isn't recommended because the resulting files can be large.
 
 ## Example usage
 Apply all three metrics against strings in input.txt that match a filename pattern and save the resulting link charts as SVG files: 
 ```
 $ graph_similar_strings.py -f input.txt -m A -r filenames -o svg
 ```
 ## Help
 ```
usage: graph_similar_strings.py [-h] -f INPUT_FILE -m
                                {jaccard,J,hamming,H,levenshtein,L,all,A}
                                [-r {filenames,f}] [-o {png,svg}]

Usage: graph_similar_strings.py -f <text_file> -a [JHLA]

optional arguments:
  -h, --help            show this help message and exit
  -f INPUT_FILE, --file INPUT_FILE
                        Text file containing strings
  -m {jaccard,J,hamming,H,levenshtein,L,all,A}, --metric {jaccard,J,hamming,H,levenshtein,L,all,A}
                        Metric to calculate similarity
  -r {filenames,f}, --regex {filenames,f}
                        Filter strings first using regular expression
  -o {png,svg}, --output {png,svg}
                        Output image format (requires Graphviz to be in your
                        PATH)
 ```
 
 ## Output
 Example filename similarity link chart using Levenshtein distance (cropped). Here each node represents a unique filename that is connected by edges to other filenames that met the similarity threshold.
 
 <img src="https://github.com/cryptogramfan/Malware-Analysis-Scripts/blob/master/graph_similar_strings/images/graph_similar_strings_screenshot_1.png" width="700">